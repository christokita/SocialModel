theme_bw() +
scale_colour_gradient(high = "#2c7bb6", low = "#d7191c") +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
ThreshCutoffValue <- 10
graphs <- unlist(groups_graphs, recursive = FALSE)
load("output/Rdata/Sigma001-Eps001-Phi001-ConnectP01-Bias1.1.Rdata")
graphs <- unlist(groups_graphs, recursive = FALSE)
threshMat <- unlist(groups_thresh, recursive = FALSE)
actMat <- unlist(groups_taskDist, recursive = FALSE)
social_graphs <- lapply(1:length(graphs), function(i) {
# Calculated degree
degree <- rowSums(graphs[[i]])
degree <- as.data.frame(degree)
degree$Id <- row.names(degree)
# Calculate thresholds
thresh <- threshMat[[i]] %>%
as.data.frame(.) %>%
mutate(ThreshRatio = log(Thresh1 / Thresh2),
Id = row.names(.))
thresh$ThreshRatio[thresh$ThreshRatio > ThreshCutoffValue] <- ThreshCutoffValue
thresh$ThreshRatio[thresh$ThreshRatio < -ThreshCutoffValue] <- -ThreshCutoffValue
# Calculate actibity
activity <- actMat[[i]] %>%
as.data.frame(.) %>%
mutate(ActRatio = log(Task1 / Task2),
ActTotal = Task1 + Task2,
Id = row.names(.))
# Merge and return
mergedNodes <- merge(degree, thresh)
mergedNodes <- merge(mergedNodes, activity)
return(mergedNodes)
})
social_graphs <- do.call("rbind", social_graphs)
load("output/Rdata/Sigma001-FIXED-ConnectP01-Bias1.1.Rdata")
graphs <- unlist(groups_graphs, recursive = FALSE)
threshMat <- unlist(groups_thresh, recursive = FALSE)
actMat <- unlist(groups_taskDist, recursive = FALSE)
fixed_graphs <- lapply(1:length(graphs), function(i) {
# Calculated degree
degree <- rowSums(graphs[[i]])
degree <- as.data.frame(degree)
degree$Id <- row.names(degree)
# Calculate thresholds
thresh <- threshMat[[i]] %>%
as.data.frame(.) %>%
mutate(ThreshRatio = log(Thresh1 / Thresh2),
Id = row.names(.))
thresh$ThreshRatio[thresh$ThreshRatio > ThreshCutoffValue] <- ThreshCutoffValue
thresh$ThreshRatio[thresh$ThreshRatio < -ThreshCutoffValue] <- -ThreshCutoffValue
# Calculate actibity
activity <- actMat[[i]] %>%
as.data.frame(.) %>%
mutate(ActRatio = log(Task1 / Task2),
ActTotal = Task1 + Task2,
Id = row.names(.))
# Merge and return
mergedNodes <- merge(degree, thresh)
mergedNodes <- merge(mergedNodes, activity)
return(mergedNodes)
})
fixed_graphs <- do.call("rbind", fixed_graphs)
test <- combined_graphs %>%
filter(n == 100)
test <- social_graphs %>% filter(n == 100)
qplot(data = test, y = ThreshRatio, x = degree) +
theme_bw() +
scale_colour_gradient(high = "#2c7bb6", low = "#d7191c") +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
View(test)
View(social_graphs)
qplot(data = social_graphs, y = ActRatio, x=ThreshRatio)
load("output/Rdata/Sigma001-Eps001-Phi001-ConnectP01-Bias1.1.Rdata")
graphs <- unlist(groups_graphs, recursive = FALSE)
threshMat <- unlist(groups_thresh, recursive = FALSE)
actMat <- unlist(groups_taskDist, recursive = FALSE)
social_graphs <- lapply(1:length(graphs), function(i) {
# Calculated degree
degree <- rowSums(graphs[[i]])
degree <- as.data.frame(degree)
degree$Id <- row.names(degree)
# Calculate thresholds
thresh <- threshMat[[i]] %>%
as.data.frame(.) %>%
mutate(ThreshRatio = log(Thresh1 / Thresh2),
Id = row.names(.))
thresh$ThreshRatio[thresh$ThreshRatio > ThreshCutoffValue] <- Inf
thresh$ThreshRatio[thresh$ThreshRatio < -ThreshCutoffValue] <- -Inf
# Calculate actibity
activity <- actMat[[i]] %>%
as.data.frame(.) %>%
mutate(ActRatio = log(Task1 / Task2),
ActTotal = Task1 + Task2,
Id = row.names(.))
# Merge and return
mergedNodes <- merge(degree, thresh)
mergedNodes <- merge(mergedNodes, activity)
return(mergedNodes)
})
social_graphs <- do.call("rbind", social_graphs)
test <- social_graphs %>% filter(n == 100)
qplot(data = social_graphs, y = ActRatio, x=ThreshRatio)
qplot(data = test, y = ThreshRatio, x = degree) +
theme_bw() +
scale_colour_gradient(high = "#2c7bb6", low = "#d7191c") +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
qplot(data = social_graphs, y = ActRatio, x=ThreshRatio)
qplot(data = test, y = ThreshRatio, x = degree) +
theme_bw() +
scale_colour_gradient(high = "#2c7bb6", low = "#d7191c") +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient(high = "#2c7bb6", low = "#d7191c") +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
qplot(data = test, y = ThreshRatio, x = degree, color = ThreshRatio) +
theme_bw() +
scale_colour_gradient(high = "#2c7bb6", low = "#d7191c") +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
ActTotal
test <- social_graphs %>% filter(n == 100)
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient(high = "#2c7bb6", low = "#d7191c") +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
test <- social_graphs %>% filter(n == 70)
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient(high = "#2c7bb6", low = "#d7191c") +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient(high = "#005a32", low = "#a1d99b") +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient(high = "#00441b", low = "#c7e9c0") +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0") +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
test <- social_graphs %>% filter(n == 100)
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
test <- social_graphs %>% filter(n == 20)
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
test <- social_graphs %>% filter(n == 30)
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
test <- social_graphs %>% filter(n == 40)
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
test <- social_graphs %>% filter(n == 50)
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
test <- social_graphs %>% filter(n == 70)
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
test <- social_graphs %>% filter(n == 80)
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
test <- social_graphs %>% filter(n == 5)
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
test <- social_graphs %>% filter(n == 10)
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
test <- social_graphs %>% filter(n == 70)
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
test <- social_graphs %>% filter(n == 100)
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
stim <- groups_stim[[1]]
test <- fixed_graphs %>% filter(n == 100)
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
gg_thresh_degree <- ggplot(data = social_graphs,
aes(x = ThreshRatio, y = degree, colour = ActTotal, group = n)) +
geom_point() +
theme_bw() +
scale_colour_gradient2(high = "#6e016b",
mid = "#8c6bb1",
low = "#bfd3e6",
limits = c(0, 1),
midpoint = 0.5,
oob = squish) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
facet_wrap( ~ n, scales = "free_y")
gg_thresh_degree
gg_thresh_degree <- ggplot(data = social_graphs,
aes(y = ThreshRatio, x = degree, colour = ActTotal, group = n)) +
geom_point() +
theme_bw() +
scale_colour_gradient2(high = "#6e016b",
mid = "#8c6bb1",
low = "#bfd3e6",
limits = c(0, 1),
midpoint = 0.5,
oob = squish) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
facet_wrap( ~ n, scales = "free_y")
gg_thresh_degree
gg_thresh_degree <- ggplot(data = social_graphs,
aes(y = ThreshRatio, x = degree, colour = ActTotal, group = n)) +
geom_point() +
theme_bw() +
scale_colour_gradient2(high = "#6e016b",
mid = "#8c6bb1",
low = "#bfd3e6",
limits = c(0, 1),
midpoint = 0.5,
oob = squish) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
facet_wrap( ~ n, scales = "free_x")
gg_thresh_degree
gg_thresh_degree <- ggplot(data = social_graphs,
aes(x = ThreshRatio, y = degree, colour = ActTotal, group = n)) +
geom_point() +
theme_bw() +
scale_colour_gradient2(high = "#6e016b",
mid = "#8c6bb1",
low = "#bfd3e6",
limits = c(0, 1),
midpoint = 0.5,
oob = squish) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
facet_wrap( ~ n)
gg_thresh_degree
gg_thresh_degree <- ggplot(data = social_graphs,
aes(x = ThreshRatio, colour = degree, y = ActTotal, group = n)) +
geom_point() +
theme_bw() +
scale_colour_gradient2(high = "#6e016b",
mid = "#8c6bb1",
low = "#bfd3e6",
limits = c(0, 1),
midpoint = 0.5,
oob = squish) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
facet_wrap( ~ n)
gg_thresh_degree
gg_thresh_degree <- ggplot(data = social_graphs,
aes(x = ThreshRatio, colour = degree, group = n)) +
geom_point() +
theme_bw() +
scale_colour_gradient2(high = "#6e016b",
mid = "#8c6bb1",
low = "#bfd3e6",
limits = c(0, 1),
midpoint = 0.5,
oob = squish) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
facet_wrap( ~ n)
gg_thresh_degree
gg_thresh_degree <- ggplot(data = social_graphs,
aes(x = ThreshRatio, colour = ActTotal, group = n)) +
geom_point() +
theme_bw() +
scale_colour_gradient2(high = "#6e016b",
mid = "#8c6bb1",
low = "#bfd3e6",
limits = c(0, 1),
midpoint = 0.5,
oob = squish) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
facet_wrap( ~ n)
gg_thresh_degree
gg_thresh_degree <- ggplot(data = social_graphs,
aes(x = ThreshRatio, y = ActTotal, group = n)) +
geom_point() +
theme_bw() +
scale_colour_gradient2(high = "#6e016b",
mid = "#8c6bb1",
low = "#bfd3e6",
limits = c(0, 1),
midpoint = 0.5,
oob = squish) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
facet_wrap( ~ n)
gg_thresh_degree
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
test <- fixed_graphs %>% filter(n == 100)
qplot(data = test, y = ThreshRatio, x = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
qplot(data = test, x = ThreshRatio, y = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
gg_thresh_degree <- ggplot(data = social_graphs,
aes(x = ThreshRatio, y = degree, colour = ActTotal, group = n)) +
geom_point() +
theme_bw() +
scale_colour_gradient2(high = "#6e016b",
mid = "#8c6bb1",
low = "#bfd3e6",
limits = c(0, 1),
midpoint = 0.5,
oob = squish) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
facet_wrap( ~ n)
gg_thresh_degree
gg_thresh_degree <- ggplot(data = social_graphs,
aes(x = ThreshRatio, y = degree, colour = ActTotal, group = n)) +
geom_point() +
theme_bw() +
scale_colour_gradient2(high = "#6e016b",
mid = "#8c6bb1",
low = "#bfd3e6",
limits = c(0, 1),
midpoint = 0.5,
oob = squish) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
facet_wrap( ~ n, scales = "free_y")
gg_thresh_degree
gg_thresh_degree <- ggplot(data = social_graphs,
aes(x = ThreshRatio, y = degree, colour = ActTotal, group = n)) +
geom_point() +
theme_bw() +
scale_colour_gradient2(high = "#00441b",
mid = "#41ab5d",
low = "#c7e9c0",
midpoint = 0.5,
limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
facet_wrap( ~ n, scales = "free_y")
gg_thresh_degree
gg_degree_act <- ggplot(data = social_graphs,
aes(x = ActTotal, y = degree, colour = ThreshRatio, group = n)) +
geom_point(size = 0.5) +
theme_bw() +
scale_colour_gradient2(high = "#d7191c",
mid = "#ffffbf",
low = "#2c7bb6",
midpoint = 0,
limits = c(-2, 2),
oob = squish) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
xlab("Total Activity Level") +
ylab("Total Degree") +
facet_wrap( ~ n, scales = "free_y")
gg_degree_act
gg_degree_act <- ggplot(data = social_graphs,
aes(x = ActTotal, y = degree, colour = ThreshRatio, group = n)) +
geom_point(size = 0.5) +
theme_bw() +
scale_colour_gradient2(name = "Threshold Ratio",
high = "#d7191c",
mid = "#ffffbf",
low = "#2c7bb6",
midpoint = 0,
limits = c(-2, 2),
oob = squish) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
xlab("Total Activity Level") +
ylab("Total Degree") +
facet_wrap( ~ n, scales = "free_y")
gg_degree_act
gg_degree_act <- ggplot(data = social_graphs,
aes(x = ActTotal, y = degree, colour = ThreshRatio, group = n)) +
geom_point(size = 0.5) +
theme_bw() +
scale_colour_gradient2(name = "Threshold\nRatio",
high = "#d7191c",
mid = "#ffffbf",
low = "#2c7bb6",
midpoint = 0,
limits = c(-2, 2),
oob = squish) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
xlab("Total Activity Level") +
ylab("Total Degree") +
facet_wrap( ~ n, scales = "free_y")
gg_degree_act
gg_FIX_degree_act <- ggplot(data = fixed_graphs,
aes(x = ActTotal, y = degree, colour = ThreshRatio, group = n)) +
geom_point() +
theme_bw() +
scale_colour_gradient2(name = "Threshold\nRatio",
high = "#2c7bb6",
mid = "#ffffbf",
low = "#d7191c",
midpoint = 0,
limits = c(-2, 2),
oob = squish) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
facet_wrap( ~ n, scales = "free_y")
gg_FIX_degree_act
gg_thresh_degree <- ggplot(data = social_graphs,
aes(x = ThreshRatio, y = degree, colour = ActTotal, group = n)) +
geom_point() +
theme_bw() +
scale_colour_gradient2(high = "#00441b",
mid = "#41ab5d",
low = "#c7e9c0",
midpoint = 0.5,
limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
facet_wrap( ~ n, scales = "free_y")
gg_thresh_degree
gg_degree_act
ggsave(filename = "output/NetworkDataPlots/Social_ThreshRatioVsDegree.png", width = 8, height = 6, units = "in", dpi = 600)
gg_thresh_degree
ggsave(filename = "output/NetworkDataPlots/Social_ThreshRatioVsDegree.png", width = 8, height = 6, units = "in", dpi = 600)
gg_FIX_thresh_degree <- ggplot(data = fixed_graphs,
aes(x = ThreshRatio, y = degree, colour = ActTotal, group = n)) +
geom_point() +
theme_bw() +
scale_colour_gradient2(high = "#00441b",
mid = "#41ab5d",
low = "#c7e9c0",
midpoint = 0.5,
limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA)) +
facet_wrap( ~ n, scales = "free_y")
gg_FIX_thresh_degree
ggsave(filename = "output/NetworkDataPlots/Fixed_ThreshRatioVsDegree.png", width = 8, height = 6, units = "in", dpi = 600)
test <- fixed_graphs %>% filter(n == 100)
qplot(data = test, x = ThreshRatio, y = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
test <- social_graphs %>% filter(n == 100)
qplot(data = test, x = ThreshRatio, y = degree, color = ActTotal) +
theme_bw() +
scale_colour_gradient2(high = "#00441b", mid = "#41ab5d", low = "#c7e9c0", midpoint = 0.5, limits = c(0, 1)) +
theme(panel.grid = element_blank(),
panel.border = element_rect(size = 1, fill = NA))
