{
    "collab_server" : "",
    "contents" : "##################################################\n#\n# Resampling CI Functions\n#\n##################################################\n\n\n####################\n# Generate CI\n####################\nresampleCI <- function(TaskDistList, resampleNumber) {\n  # Get last group size (this will be resampled from)\n  lastSize <- length(TaskDistList)\n  toResample <- TaskDistList[[lastSize]]\n  # Get group sizes of smaller groups\n  sizes <- lapply(1:length(TaskDistList), function(x) {\n    set <- TaskDistList[[x]]\n    len <- nrow(set[[1]])\n    return(len)\n  })\n  sizes <- unlist(sizes)\n  # Resample\n  resampledStats <- resampleStatistics(sizes = sizes, largestGroupList = toResample, resampleNumber = resampleNumber)\n  resampledStats <- do.call(\"rbind\", resampledStats)\n  # Calculate mean value and sd by size\n  sumStats <- resampledStats %>% \n    group_by(n) %>% \n    summarise(Mean1_avg = mean(Mean1),\n              Mean1_95CI  = 1.96 * (sd(Mean1) / sqrt(length(Mean1))),\n              SD1_avg = mean(SD1),\n              SD1_95CI = 1.96 * (sd(SD1) / sqrt(length(SD1))),\n              SD2_avg = mean(SD2),\n              SD2_95CI = 1.96 * (sd(SD2) / sqrt(length(SD2))),\n              SD_avg = mean(SD),\n              SD_95CI = 1.96 * (sd(SD) / sqrt(length(SD))),\n              SD_95Dist = 1.96 * sd(SD))\n  return(sumStats)\n}\n\n\n####################\n# Resample values from the largest group size\n####################\nresampleStatistics <- function(sizes, largestGroupList, resampleNumber) {\n  resampledStats <- lapply(sizes, function(size) {\n    # Repeat the resampling process\n    replicateSamp <- list()\n    for (i in 1:resampleNumber) {\n      # Loop through replicates in largest group size\n      sizeStats <- lapply(1:length(largestGroupList), function(x) {\n        rep <- largestGroupList[[x]]\n        # Sample required number from each colony\n        sampledDist1 <- sample(rep$Task1, size = size, replace = FALSE)\n        sampleSD1 <- sd(sampledDist1)\n        sampleMean1 <- mean(sampledDist1)\n        sampledDist2 <- sample(rep$Task2, size = size, replace = FALSE)\n        sampleSD2 <- sd(sampledDist2)\n        sampleMean2 <- mean(sampledDist2)\n        # Put in dataframe and return\n        sampledDist <- data.frame(SD1 = sampleSD1, Mean1 = sampleMean1,\n                                  SD2 = sampleSD2, Mean2 = sampleMean2)\n        return(sampledDist)\n      })\n      # Unlist and bind\n      sizeStats <- do.call(\"rbind\", sizeStats)\n      # Get mean value of SD and Mean\n      stats <- sizeStats %>% \n        summarise(n = size, SD1 = mean(SD1), Mean1 = mean(Mean1), SD2 = mean(SD2), Mean2 = mean(Mean2)) %>% \n        mutate(SD = (SD1 + SD2) / 2)\n      replicateSamp[[i]] <- stats\n    }\n    # Bind\n    replicateSamp <- do.call(\"rbind\", replicateSamp)\n    return(replicateSamp)\n  })\n}\n\n\n####################\n# Generate CI\n####################\nresampleCI_experiment <- function(ExperimentalData, resampleNumber) {\n  # Get last group size (this will be resampled from)\n  lastSize <- max(ExperimentalData$GS)\n  toResample <- ExperimentalData %>% \n    filter(GS == lastSize)\n  # Get group sizes of smaller groups\n  sizes <- unique(ExperimentalData$GS)\n  # Resample\n  resampledStats <- resampleStatistics_experiment(sizes = sizes, largestGroupList = toResample, resampleNumber = resampleNumber)\n  resampledStats <- do.call(\"rbind\", resampledStats)\n  # Calculate mean value and sd by size\n  sumStats <- resampledStats %>% \n    group_by(n) %>% \n    summarise(Mean_avg = mean(Mean),\n              Mean_95CI  = 1.96 * (sd(Mean) / sqrt(length(Mean))),\n              Mean_95Dist = sd(Mean) * 1.96,\n              SD_avg = mean(SD),\n              SD_95Dist = sd(SD) * 1.96,\n              SD_95CI = 1.96 * (sd(SD) / sqrt(length(SD))))\n  return(sumStats)\n}\n\n\n####################\n# Resample values from the largest group size\n####################\nresampleStatistics_experiment <- function(sizes, largestGroupList, resampleNumber) {\n  # Unique colonies\n  largestGroupList <- largestGroupList %>% \n    filter(!is.na(RMSDnorm))\n  colonies <- unique(largestGroupList$boxID)\n  # sample\n  resampledStats <- lapply(sizes, function(size) {\n    # Repeat the resampling process\n    replicateSamp <- list()\n    for (i in 1:resampleNumber) {\n      # Loop through replicates in largest group size\n      sizeStats <- lapply(1:length(colonies), function(x) {\n        rep <- largestGroupList[largestGroupList$boxID == colonies[x], ]\n        # Sample required number from each colony\n        sampledDist <- sample(rep$RMSDnorm, size = size, replace = FALSE)\n        sampleSD <- sd(sampledDist)\n        sampleMean <- mean(sampledDist)\n        # Put in dataframe and return\n        sampledDist <- data.frame(SD = sampleSD, Mean = sampleMean)\n        return(sampledDist)\n      })\n      # Unlist and bind\n      sizeStats <- do.call(\"rbind\", sizeStats)\n      # Get mean value of SD and Mean\n      stats <- sizeStats %>% \n        summarise(n = size, SD = mean(SD), Mean = mean(Mean))\n      replicateSamp[[i]] <- stats\n    }\n    # Bind\n    replicateSamp <- do.call(\"rbind\", replicateSamp)\n    return(replicateSamp)\n  })\n}\n\n",
    "created" : 1512425699043.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "437046623",
    "id" : "7AFE89FA",
    "lastKnownWriteTime" : 1495768004,
    "last_content_update" : 1495768004,
    "path" : "~/Documents/Research/Tarnita Lab/Social Interaction DOL/SocialModel/scripts/__Util__ResamplingCIFunctions.R",
    "project_path" : "scripts/__Util__ResamplingCIFunctions.R",
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}