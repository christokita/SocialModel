{
    "collab_server" : "",
    "contents" : "##################################################\n#\n# Global Stimulus Functions \n#\n##################################################\n\n\n####################\n# Seed Stimuls\n####################\nseedStimuls <- function(InitialSVector, gens) {\n  # Calculate number of blank spots to make\n  repLength <- (length(InitialSVector)) * gens #intiial row does not count as gen\n  # Build matrix\n  stim <- matrix(data = c(InitialSVector, rep(NA, repLength)),\n                 byrow = TRUE, \n                 nrow = (gens + 1))\n  # Fix Names\n  colnames(stim) <- paste0(rep(\"s\", length(InitialSVector)), 1:length(InitialSVector))\n  rownames(stim) <- paste0(\"Gen\", 0:gens)\n  # Return\n  return(stim)\n}\n\n####################\n# Stimulus Level\n####################\n# Frequency dependent\nglobalStimUpdate <- function(stimulus, delta, alpha, Ni, n) {\n  # Calculate\n  s <- stimulus + delta - ( alpha * ( Ni / n ))\n  # If negative, make zero\n  if(s < 0.0001) {\n    s <- 0\n  }\n  return(s)\n}\n\n# Density dependent (per capita)\nglobalStimUpdate_PerCap <- function(stimulus, delta, alpha, Ni, n, m, quitP) {\n  # Calculate\n  s <- stimulus + (alpha * (delta ) * (n / m)) - (Ni * alpha)\n  # s <- stimulus + (alpha * (delta ) * (1 / (1 + quitP)) * (n / m)) - (Ni * alpha)\n  # If negative, make zero\n  if(s < 0.0001) {\n    s <- 0\n  }\n  return(s)\n}\n\n####################\n# Update Exhuastion\n####################\nupdateExhaustStim <- function(ExhaustStim, TaskExhaustVect, ExhaustRate, StateMat) {\n  # Zero out stim for those that are inactive\n  for (i in 1:nrow(StateMat)) {\n    if (sum(StateMat[i, ]) == 0) {\n      ExhaustStim[i] <- 0\n    }\n  }\n  # Get relative rate increase for task being performed\n  TaskRate <- StateMat %*% TaskExhaustVect\n  # Get rate increase for time step\n  StimIncrease <- TaskRate %*% ExhaustRate\n  # Update Stim\n  NewExhaust <- ExhaustStim + StimIncrease\n  # Return \n  return(NewExhaust)\n}",
    "created" : 1511319711358.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2430956231",
    "id" : "2B794B00",
    "lastKnownWriteTime" : 1509228560,
    "last_content_update" : 1509228560,
    "path" : "~/Documents/Research/Tarnita Lab/Social Interaction DOL/SocialModel/scripts/__Util_StimulusFunctions.R",
    "project_path" : "scripts/__Util_StimulusFunctions.R",
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}